# オプション解説

## 📋 ドライラン（コマンド実行をスキップ）

**概要**: コマンドを実際には実行せず、プランの生成のみを行うモードです。

### フロー

1. **UI 側の設定**
   - `frontend/src/App.tsx` のチェックボックスで `dryRun` フラグを有効化。
   - `/api/tasks` に送るリクエストへ自動的に `dryRun=true` が付与されます。

2. **サーバー側の処理**
   - `MediaAgentServer` (`backend/src/server/MediaAgentServer.ts`) が `parseBoolean` で `dryRun` を解釈します。
   - 実行フェーズに渡すオプションとして `dryRun: true` が設定されます。

3. **エージェントの動作**
   - プランのみを生成し、`CommandExecutor` が実コマンドをスキップします。
   - レスポンスには **「ドライラン」** タグとスキップ情報が含まれます。

---

## 🐛 プラン生成のデバッグ情報を含める

**概要**: プラン生成プロセスの詳細情報を取得します。

### フロー

1. **UI 側の設定**
   - `App.tsx` のチェックボックスで `debugEnabled` をオン。
   - クエリに `debug=true` を付けて `/api/tasks` に送信します。

2. **サーバー側の処理**
   - `parseDebugMode` でフラグを解釈し、`MediaAgentServer` が `debug: true` をプランナーへ渡します。

3. **プランナーの動作**
   - OpenAI プランナーが以下の情報を付与します。
     - 開発用プロンプト
     - パース結果
     - その他デバッグ情報

4. **UI 側の表示**
   - 「デバッグ」セクションで確認可能（`frontend/src/App.tsx` のサイドドロワー）。

---

## 🔍 生レスポンスを含める（詳細モード）

**概要**: LLM の生レスポンス全体を取得する詳細デバッグモードです。

> ⚠️ **注意**: このオプションは「デバッグ情報を含める」が有効な場合のみ使用できます。

### フロー

1. **UI 側の設定**
   - `App.tsx` の入れ子チェックボックスで `debugVerbose` をオン。
   - クエリに `debug=verbose`（または `debug=full`）を付けます。

2. **サーバー側の処理**
   - `MediaAgentServer` が `includeRaw` を `true` に設定し、`MediaAgent` に `includeRawResponse` を渡します。

3. **プランナーの動作**
   - LLM の生レスポンス全体を安全にシリアライズし、デバッグ payload に同梱します。

4. **UI 側の表示**
   - 「生レスポンス」ビューで JSON をそのまま確認できます（`frontend/src/App.tsx`）。

---

## 💡 使い分けのヒント

- **開発中**: ドライランとデバッグを併用すると、コマンド実行なしでプラン生成の問題を特定できます。
- **トラブルシューティング**: 生レスポンスを含めると、LLM の出力を詳細に追跡できます。
- **本番運用**: デバッグオプションは無効化し、必要な場合のみドライランを利用してください。
